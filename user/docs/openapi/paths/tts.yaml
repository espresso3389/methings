ttsInit:
  post:
    operationId: postTtsInit
    summary: Initialize TTS engine
    tags: [TTS]
    x-permission:
      tool: device.tts
      capability: tts
    requestBody:
      required: false
      content:
        application/json:
          schema:
            allOf:
              - type: object
                properties:
                  engine:
                    type: string
                    description: TTS engine package name (optional; uses system default).
              - $ref: '../components/schemas.yaml#/PermissionFields'
          example:
            engine: com.google.android.tts
    responses:
      '200':
        description: TTS engine initialized.
        content:
          application/json:
            schema:
              type: object
              required: [status]
              properties:
                status:
                  type: string
                  const: ok
      '403':
        description: Permission required.
        content:
          application/json:
            schema:
              $ref: '../components/schemas.yaml#/PermissionRequiredResponse'
      '500':
        description: TTS initialization failed.
        content:
          application/json:
            schema:
              $ref: '../components/schemas.yaml#/ErrorResponse'

ttsVoices:
  get:
    operationId: getTtsVoices
    summary: List available TTS voices
    tags: [TTS]
    x-permission:
      tool: device.tts
      capability: tts
    parameters:
      - name: identity
        in: query
        schema:
          type: string
        description: Caller identity (e.g. chat session ID).
      - name: permission_id
        in: query
        schema:
          type: string
        description: Previously approved permission request ID.
    responses:
      '200':
        description: List of available voices.
        content:
          application/json:
            schema:
              type: object
              required: [status, voices]
              properties:
                status:
                  type: string
                  const: ok
                voices:
                  type: array
                  items:
                    type: object
                    properties:
                      name:
                        type: string
                      locale:
                        type: string
                        description: BCP-47 locale tag.
                      quality:
                        type: integer
                      network_required:
                        type: boolean
      '403':
        description: Permission required.
        content:
          application/json:
            schema:
              $ref: '../components/schemas.yaml#/PermissionRequiredResponse'

ttsSpeak:
  post:
    operationId: postTtsSpeak
    summary: Speak text on the device speaker
    tags: [TTS]
    x-permission:
      tool: device.tts
      capability: tts
    requestBody:
      required: true
      content:
        application/json:
          schema:
            allOf:
              - type: object
                required: [text]
                properties:
                  text:
                    type: string
                    description: Text to speak.
                  voice:
                    type: string
                    description: Voice name (from tts.voices).
                  locale:
                    type: string
                    description: BCP-47 locale tag (e.g. en-US, ja-JP).
                  rate:
                    type: number
                    format: float
                    description: Speech rate (~0.1..3.0).
                  pitch:
                    type: number
                    format: float
                    description: Speech pitch (~0.1..3.0).
              - $ref: '../components/schemas.yaml#/PermissionFields'
          example:
            text: "Hello, world!"
            locale: en-US
            rate: 1.0
    responses:
      '200':
        description: Speech started.
        content:
          application/json:
            schema:
              type: object
              required: [status]
              properties:
                status:
                  type: string
                  const: ok
      '403':
        description: Permission required.
        content:
          application/json:
            schema:
              $ref: '../components/schemas.yaml#/PermissionRequiredResponse'

ttsStop:
  post:
    operationId: postTtsStop
    summary: Stop current TTS speech
    tags: [TTS]
    x-permission:
      tool: device.tts
      capability: tts
    requestBody:
      required: false
      content:
        application/json:
          schema:
            allOf:
              - type: object
              - $ref: '../components/schemas.yaml#/PermissionFields'
    responses:
      '200':
        description: Speech stopped.
        content:
          application/json:
            schema:
              type: object
              required: [status]
              properties:
                status:
                  type: string
                  const: ok
      '403':
        description: Permission required.
        content:
          application/json:
            schema:
              $ref: '../components/schemas.yaml#/PermissionRequiredResponse'
