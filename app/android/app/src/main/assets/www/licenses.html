<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Licenses - me.things</title>
    <style>
      body {
        margin: 0;
        font: 14px/1.5 -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        color: #e9edf2;
        background: #0b1020;
      }
      .wrap {
        max-width: 920px;
        margin: 0 auto;
        padding: 18px 14px 40px;
      }
      h1 {
        margin: 0 0 6px;
        font-size: 24px;
      }
      h2 {
        margin: 20px 0 8px;
        font-size: 18px;
      }
      .muted {
        color: #9aa7bb;
      }
      .card {
        border: 1px solid rgba(255, 255, 255, 0.12);
        border-radius: 10px;
        padding: 12px;
        background: rgba(255, 255, 255, 0.03);
        margin-top: 12px;
      }
      pre {
        white-space: pre-wrap;
        margin: 0;
        color: #d8e0ec;
      }
      a {
        color: #77c4ff;
      }
      .top {
        margin-top: 8px;
      }
      button {
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 8px;
        background: rgba(255, 255, 255, 0.08);
        color: #fff;
        padding: 8px 12px;
      }
    </style>
  </head>
  <body>
    <div class="wrap">
      <h1>Licenses</h1>
      <div class="muted">App license and third-party open source notices.</div>
      <div class="top">
        <button onclick="history.back()">Back</button>
      </div>

      <h2>me.things</h2>
      <div class="card">
        <div class="muted">MIT License</div>
        <pre>Copyright (c) 2026 Takashi Kawasaki (@espresso3389)</pre>
      </div>

      <h2>Third-Party OSS</h2>
      <div class="card">
        <div id="depSummary" class="muted">Loading dependency inventory...</div>
        <ul id="depList"></ul>
        <div class="muted">
          Source repository:
          <a href="https://github.com/espresso3389/methings" target="_blank" rel="noopener">https://github.com/espresso3389/methings</a>
        </div>
      </div>
    </div>
    <script>
      (async function() {
        const summary = document.getElementById("depSummary");
        const list = document.getElementById("depList");
        try {
          const res = await fetch("licenses/dependency_inventory.json", { cache: "no-store" });
          if (!res.ok) throw new Error("inventory not found");
          const data = await res.json();
          const deps = Array.isArray(data.dependencies) ? data.dependencies : [];
          summary.textContent = "Dependencies: " + deps.length;
          if (deps.length === 0) {
            list.innerHTML = "<li>(empty)</li>";
            return;
          }
          const frag = document.createDocumentFragment();
          for (const d of deps) {
            const li = document.createElement("li");
            const name = String(d.name || "(unknown)");
            const ver = String(d.version || "").trim();
            const eco = String(d.ecosystem || "").trim();
            const lic = String(d.license || "").trim();
            let line = name;
            if (ver) line += "@" + ver;
            if (eco) line += " [" + eco + "]";
            if (lic) line += " - " + lic;
            li.textContent = line;
            frag.appendChild(li);
          }
          list.innerHTML = "";
          list.appendChild(frag);
        } catch (_) {
          summary.textContent = "Dependency inventory is not available in this build.";
          list.innerHTML = "";
        }
      })();
    </script>
  </body>
  </html>
